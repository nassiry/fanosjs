{"version":3,"file":"fanos.umd.js","sources":["../src/config.js","../src/utils.js","../src/randomUUID.js","../src/requestHandler.js","../src/fanos.js"],"sourcesContent":["export const config = Object.freeze({\n  url: null,\n  headers: { 'Content-Type': 'application/json' },\n  storeKey: '__FANOS__',\n  autoFlush: true,\n  storeFailed: true,\n  debug: false,\n  retryInterval: 5000,\n  maxPayloadSize: 64000,\n  maxAttemptsPerRequest: 3,\n  maxRetryCycles: 10,\n  maxRetryDelay: 300000,\n  fallbackToFetch: false,\n})\n","export const normalizePayload = (data, headers) => {\n  if (\n    data instanceof Blob ||\n    data instanceof FormData ||\n    data instanceof URLSearchParams\n  ) {\n    return data\n  }\n  return new Blob([JSON.stringify(data)], { type: headers['Content-Type'] })\n}\n\nexport const createPayload = (data, headers) => normalizePayload(data, headers)\n\nexport const getPayloadSize = (payload) => {\n  if (payload instanceof Blob) return payload.size\n  if (payload instanceof FormData) {\n    return [...payload.entries()].reduce(\n      (size, [key, value]) =>\n        size + key.length + (typeof value === 'string' ? value.length : 0),\n      0,\n    )\n  }\n  if (payload instanceof URLSearchParams) {\n    return new TextEncoder().encode(payload.toString()).length\n  }\n  return new TextEncoder().encode(JSON.stringify(payload)).length\n}\n\nexport function debounce(fn, delay) {\n  let timeout\n  return (...args) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => fn.apply(this, args), delay)\n  }\n}\n\nexport const debugLog = (debug, ...args) => {\n  if (debug === true || debug === 'info') {\n    console.debug('[Fanos]', ...args)\n  }\n}\n","import { debugLog } from './utils.js'\n\nexport const randomUUID = (debug) => {\n  try {\n    if (crypto && crypto.randomUUID) {\n      return crypto.randomUUID()\n    }\n  } catch (e) {\n    debugLog(\n      debug,\n      'crypto.randomUUID() failed, falling back to alternative method',\n      e,\n    )\n  }\n\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0,\n      v = c === 'x' ? r : (r & 0x3) | 0x8\n    return v.toString(16)\n  })\n}\n","import {\n  createPayload,\n  debugLog,\n  getPayloadSize,\n  normalizePayload,\n} from './utils.js'\n\nimport { randomUUID } from './randomUUID.js'\n\nexport class RequestHandler {\n  constructor(config, queue) {\n    this._config = config\n    this._queue = queue\n  }\n\n  sendRequest(request) {\n    const payload = createPayload(request.data, request.headers)\n    const payloadSize = getPayloadSize(payload)\n\n    if (payloadSize > this._config.maxPayloadSize) {\n      debugLog(this._config.debug, 'Warning: Payload too large, splitting...')\n      return this.splitAndSend(request)\n    }\n\n    const success = navigator.sendBeacon(request.url, payload)\n    if (success) {\n      debugLog(this._config.debug, 'Beacon succeeded:', request.id)\n      this._queue.delete(request)\n      return true\n    }\n\n    if (this._config.fallbackToFetch) {\n      return this.fetchFallback(request)\n    }\n\n    return false\n  }\n  createRequest(data, options) {\n    return {\n      id: randomUUID(this._config.debug),\n      url: options.url || this._config.url,\n      headers: { ...this._config.headers, ...options.headers },\n      data,\n      attempts: 0,\n      timestamp: Date.now(),\n    }\n  }\n\n  async splitAndSend(request) {\n    debugLog(this._config.debug, `Splitting large request: ${request.id}`)\n\n    const payload = normalizePayload(request.data, request.headers)\n    const payloadStr =\n      payload instanceof Blob\n        ? await payload.text()\n        : JSON.stringify(request.data)\n    const chunkSize = this._config.maxPayloadSize - 1000\n    const chunks = []\n\n    for (let i = 0; i < payloadStr.length; i += chunkSize) {\n      chunks.push(payloadStr.slice(i, i + chunkSize))\n    }\n\n    let allSent = true\n    chunks.forEach((chunk, index) => {\n      const chunkBlob = new Blob([chunk], {\n        type: request.headers['Content-Type'],\n      })\n      const success = navigator.sendBeacon(request.url, chunkBlob)\n      if (!success) {\n        debugLog(this._config.debug, `Chunk ${index + 1} failed to send`)\n        allSent = false\n      }\n    })\n\n    if (allSent) {\n      this._queue.delete(request)\n    }\n\n    return allSent\n  }\n\n  async fetchFallback(request) {\n    try {\n      const response = await fetch(request.url, {\n        method: 'POST',\n        headers: request.headers,\n        body: createPayload(request.data, request.headers),\n        keepalive: true,\n      })\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`HTTP ${response.status}: ${errorText}`)\n      }\n\n      debugLog(this._config.debug, 'Fetch fallback succeeded:', request.id)\n      this._queue.delete(request)\n      return true\n    } catch (error) {\n      debugLog(this._config.debug, 'Fetch fallback failed:', error)\n      return false\n    }\n  }\n}\n","// Fanos.js\nimport { config } from './config.js'\n\nimport { debounce, debugLog } from './utils.js'\nimport { RequestHandler } from './requestHandler.js'\n\nexport class Fanos {\n  static defaults = config\n  static instance = new Fanos()\n\n  constructor(options = {}) {\n    this.config = { ...Fanos.defaults, ...options }\n    this.queue = new Set()\n    this.abortController = new AbortController()\n    this.requestHandler = new RequestHandler(this.config, this.queue)\n    this.retryTimer = null\n    this._initialized = false\n  }\n\n  static send(data, options) {\n    return Fanos.instance.send(data, options)\n  }\n\n  static configure(options) {\n    Object.assign(Fanos.instance.config, options)\n    return Fanos.instance\n  }\n\n  static flush() {\n    Fanos.instance?.flush()\n  }\n\n  static destroy() {\n    Fanos.instance?.destroy()\n  }\n\n  send(data, options = {}) {\n    return new Promise((resolve, reject) => {\n      if (!this._initialized) this._initialize()\n\n      const request = this.requestHandler.createRequest(data, options)\n      debugLog(this.config.debug, 'Sending request:', { request })\n\n      try {\n        const success = this.requestHandler.sendRequest(request)\n        success ? resolve() : this._handleFailure(request, reject)\n      } catch (error) {\n        this._handleFailure(request, reject, error)\n      }\n    })\n  }\n\n  flush() {\n    if (this.queue.size === 0) {\n      debugLog(this.config.debug, 'Queue is empty, skipping flush.')\n      return\n    }\n\n    debugLog(this.config.debug, `Flushing queue with ${this.queue.size} items`)\n    const successfulRequests = new Set()\n    const maxRetry = this.config.maxAttemptsPerRequest\n\n    for (const request of this.queue) {\n      if (request.attempts >= maxRetry) continue\n      try {\n        if (this.requestHandler.sendRequest(request))\n          successfulRequests.add(request.id)\n      } catch (error) {\n        debugLog(this.config.debug, 'Flush error:', error)\n      }\n    }\n\n    this.queue.forEach((request) => {\n      if (successfulRequests.has(request.id) || request.attempts >= maxRetry) {\n        this.queue.delete(request)\n      }\n    })\n\n    if (this.queue.size > 0) {\n      this._persistQueue()\n    } else if (this.config.debug) {\n      debugLog(this.config.debug, 'Queue is empty, skipping persistence.')\n    }\n  }\n\n  destroy() {\n    debugLog(this.config.debug, 'Destroying instance')\n    this.abortController.abort()\n    clearTimeout(this.retryTimer)\n    this.queue.clear()\n    this._persistQueue()\n    this._initialized = false\n  }\n\n  _initialize() {\n    debugLog(this.config.debug, 'Initializing...')\n    this._loadQueue()\n    this._eventHandler()\n    this._scheduleRetries()\n    this._initialized = true\n  }\n\n  _handleFailure(request, reject, error = new Error('Beacon failed')) {\n    request.attempts++\n    debugLog(\n      this.config.debug,\n      `Request ${request.id} failed (attempt ${request.attempts})`,\n    )\n\n    if (this.config.storeFailed) {\n      this.queue.add(request)\n      this._persistQueue()\n    }\n\n    reject(error)\n  }\n\n  _scheduleRetries(attempt = 1) {\n    if (this.retryTimer) clearTimeout(this.retryTimer)\n\n    if (this.queue.size === 0) {\n      debugLog(this.config.debug, 'Queue is empty, stopping retries.')\n      return\n    }\n\n    const maxRetryCycles = this.config.maxRetryCycles || 10\n    if (attempt > maxRetryCycles) {\n      debugLog(\n        this.config.debug,\n        'Max retry attempts reached, stopping retries.',\n      )\n      return\n    }\n\n    const maxDelay = this.config.maxRetryDelay || 300000\n    const delay = Math.min(\n      this.config.retryInterval * 2 ** (attempt - 1),\n      maxDelay,\n    )\n\n    this.retryTimer = setTimeout(() => {\n      this.flush()\n      this._scheduleRetries(attempt + 1)\n    }, delay)\n  }\n\n  _eventHandler() {\n    if (!this.config.autoFlush) return\n\n    this.abortController.abort()\n    this.abortController = new AbortController()\n\n    const handler = () => {\n      if (this.queue.size > 0) {\n        debugLog(this.config.debug, 'Auto-flushing queue due to unload event.')\n        this.flush()\n      } else if (this.config.debug) {\n        debugLog(this.config.debug, 'Queue is empty, skipping auto-flush.')\n      }\n    }\n\n    const { signal } = this.abortController\n\n    ;['pagehide', 'beforeunload', 'visibilitychange'].forEach((event) => {\n      window.addEventListener(event, handler, { signal })\n    })\n  }\n\n  _loadQueue() {\n    try {\n      const stored = localStorage.getItem(this.config.storeKey)\n      if (stored) {\n        const parsed = JSON.parse(stored)\n        if (Array.isArray(parsed)) {\n          this.queue = new Set(parsed)\n          debugLog(\n            this.config.debug,\n            `Loaded queue from storage: ${parsed.length} items`,\n          )\n        }\n      }\n    } catch (error) {\n      debugLog(this.config.debug, 'Error loading queue:', error)\n      this.queue.clear()\n    }\n  }\n\n  _persistQueue = debounce(() => {\n    if (!this.config.storeFailed || this.queue.size === 0) {\n      if (this.config.debug) {\n        debugLog(\n          this.config.debug,\n          'Skipping persistence: queue is empty or storeFailed is false.',\n        )\n      }\n      return\n    }\n\n    try {\n      const serialized = JSON.stringify(\n        [...Array.from(this.queue)].slice(0, 100),\n      )\n      localStorage.setItem(this.config.storeKey, serialized)\n      debugLog(this.config.debug, `Persisted queue: ${this.queue.size} items`)\n    } catch (error) {\n      debugLog(this.config.debug, 'Persist error:', error)\n    }\n  }, 500)\n}\n"],"names":[],"mappings":"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"}