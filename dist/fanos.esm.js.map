{"version":3,"file":"fanos.esm.js","sources":["../src/config.js","../src/utils.js","../src/randomUUID.js","../src/requestHandler.js","../src/fanos.js"],"sourcesContent":["export const config = Object.freeze({\n  url: null,\n  headers: { 'Content-Type': 'application/json' },\n  storeKey: '__FANOS__',\n  autoFlush: true,\n  storeFailed: true,\n  debug: false,\n  retryInterval: 5000,\n  maxPayloadSize: 64000,\n  maxAttemptsPerRequest: 3,\n  maxRetryCycles: 10,\n  maxRetryDelay: 300000,\n  fallbackToFetch: false,\n})\n","export const normalizePayload = (data, headers) => {\n  if (\n    data instanceof Blob ||\n    data instanceof FormData ||\n    data instanceof URLSearchParams\n  ) {\n    return data\n  }\n  return new Blob([JSON.stringify(data)], { type: headers['Content-Type'] })\n}\n\nexport const createPayload = (data, headers) => normalizePayload(data, headers)\n\nexport const getPayloadSize = (payload) => {\n  if (payload instanceof Blob) return payload.size\n  if (payload instanceof FormData) {\n    return [...payload.entries()].reduce(\n      (size, [key, value]) =>\n        size + key.length + (typeof value === 'string' ? value.length : 0),\n      0,\n    )\n  }\n  if (payload instanceof URLSearchParams) {\n    return new TextEncoder().encode(payload.toString()).length\n  }\n  return new TextEncoder().encode(JSON.stringify(payload)).length\n}\n\nexport function debounce(fn, delay) {\n  let timeout\n  return (...args) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => fn.apply(this, args), delay)\n  }\n}\n\nexport const debugLog = (debug, ...args) => {\n  if (debug === true || debug === 'info') {\n    console.debug('[Fanos]', ...args)\n  }\n}\n","import { debugLog } from './utils.js'\n\nexport const randomUUID = (debug) => {\n  try {\n    if (crypto && crypto.randomUUID) {\n      return crypto.randomUUID()\n    }\n  } catch (e) {\n    debugLog(\n      debug,\n      'crypto.randomUUID() failed, falling back to alternative method',\n      e,\n    )\n  }\n\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0,\n      v = c === 'x' ? r : (r & 0x3) | 0x8\n    return v.toString(16)\n  })\n}\n","import {\n  createPayload,\n  debugLog,\n  getPayloadSize,\n  normalizePayload,\n} from './utils.js'\n\nimport { randomUUID } from './randomUUID.js'\n\nexport class RequestHandler {\n  constructor(config, queue) {\n    this._config = config\n    this._queue = queue\n  }\n\n  sendRequest(request) {\n    const payload = createPayload(request.data, request.headers)\n    const payloadSize = getPayloadSize(payload)\n\n    if (payloadSize > this._config.maxPayloadSize) {\n      debugLog(this._config.debug, 'Warning: Payload too large, splitting...')\n      return this.splitAndSend(request)\n    }\n\n    const success = navigator.sendBeacon(request.url, payload)\n    if (success) {\n      debugLog(this._config.debug, 'Beacon succeeded:', request.id)\n      this._queue.delete(request)\n      return true\n    }\n\n    if (this._config.fallbackToFetch) {\n      return this.fetchFallback(request)\n    }\n\n    return false\n  }\n  createRequest(data, options) {\n    return {\n      id: randomUUID(this._config.debug),\n      url: options.url || this._config.url,\n      headers: { ...this._config.headers, ...options.headers },\n      data,\n      attempts: 0,\n      timestamp: Date.now(),\n    }\n  }\n\n  async splitAndSend(request) {\n    debugLog(this._config.debug, `Splitting large request: ${request.id}`)\n\n    const payload = normalizePayload(request.data, request.headers)\n    const payloadStr =\n      payload instanceof Blob\n        ? await payload.text()\n        : JSON.stringify(request.data)\n    const chunkSize = this._config.maxPayloadSize - 1000\n    const chunks = []\n\n    for (let i = 0; i < payloadStr.length; i += chunkSize) {\n      chunks.push(payloadStr.slice(i, i + chunkSize))\n    }\n\n    let allSent = true\n    chunks.forEach((chunk, index) => {\n      const chunkBlob = new Blob([chunk], {\n        type: request.headers['Content-Type'],\n      })\n      const success = navigator.sendBeacon(request.url, chunkBlob)\n      if (!success) {\n        debugLog(this._config.debug, `Chunk ${index + 1} failed to send`)\n        allSent = false\n      }\n    })\n\n    if (allSent) {\n      this._queue.delete(request)\n    }\n\n    return allSent\n  }\n\n  async fetchFallback(request) {\n    try {\n      const response = await fetch(request.url, {\n        method: 'POST',\n        headers: request.headers,\n        body: createPayload(request.data, request.headers),\n        keepalive: true,\n      })\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`HTTP ${response.status}: ${errorText}`)\n      }\n\n      debugLog(this._config.debug, 'Fetch fallback succeeded:', request.id)\n      this._queue.delete(request)\n      return true\n    } catch (error) {\n      debugLog(this._config.debug, 'Fetch fallback failed:', error)\n      return false\n    }\n  }\n}\n","// Fanos.js\nimport { config } from './config.js'\n\nimport { debounce, debugLog } from './utils.js'\nimport { RequestHandler } from './requestHandler.js'\n\nexport class Fanos {\n  static defaults = config\n  static instance = new Fanos()\n\n  constructor(options = {}) {\n    this.config = { ...Fanos.defaults, ...options }\n    this.queue = new Set()\n    this.abortController = new AbortController()\n    this.requestHandler = new RequestHandler(this.config, this.queue)\n    this.retryTimer = null\n    this._initialized = false\n  }\n\n  static send(data, options) {\n    return Fanos.instance.send(data, options)\n  }\n\n  static configure(options) {\n    Object.assign(Fanos.instance.config, options)\n    return Fanos.instance\n  }\n\n  static flush() {\n    Fanos.instance?.flush()\n  }\n\n  static destroy() {\n    Fanos.instance?.destroy()\n  }\n\n  send(data, options = {}) {\n    return new Promise((resolve, reject) => {\n      if (!this._initialized) this._initialize()\n\n      const request = this.requestHandler.createRequest(data, options)\n      debugLog(this.config.debug, 'Sending request:', { request })\n\n      try {\n        const success = this.requestHandler.sendRequest(request)\n        success ? resolve() : this._handleFailure(request, reject)\n      } catch (error) {\n        this._handleFailure(request, reject, error)\n      }\n    })\n  }\n\n  flush() {\n    if (this.queue.size === 0) {\n      debugLog(this.config.debug, 'Queue is empty, skipping flush.')\n      return\n    }\n\n    debugLog(this.config.debug, `Flushing queue with ${this.queue.size} items`)\n    const successfulRequests = new Set()\n    const maxRetry = this.config.maxAttemptsPerRequest\n\n    for (const request of this.queue) {\n      if (request.attempts >= maxRetry) continue\n      try {\n        if (this.requestHandler.sendRequest(request))\n          successfulRequests.add(request.id)\n      } catch (error) {\n        debugLog(this.config.debug, 'Flush error:', error)\n      }\n    }\n\n    this.queue.forEach((request) => {\n      if (successfulRequests.has(request.id) || request.attempts >= maxRetry) {\n        this.queue.delete(request)\n      }\n    })\n\n    if (this.queue.size > 0) {\n      this._persistQueue()\n    } else if (this.config.debug) {\n      debugLog(this.config.debug, 'Queue is empty, skipping persistence.')\n    }\n  }\n\n  destroy() {\n    debugLog(this.config.debug, 'Destroying instance')\n    this.abortController.abort()\n    clearTimeout(this.retryTimer)\n    this.queue.clear()\n    this._persistQueue()\n    this._initialized = false\n  }\n\n  _initialize() {\n    debugLog(this.config.debug, 'Initializing...')\n    this._loadQueue()\n    this._eventHandler()\n    this._scheduleRetries()\n    this._initialized = true\n  }\n\n  _handleFailure(request, reject, error = new Error('Beacon failed')) {\n    request.attempts++\n    debugLog(\n      this.config.debug,\n      `Request ${request.id} failed (attempt ${request.attempts})`,\n    )\n\n    if (this.config.storeFailed) {\n      this.queue.add(request)\n      this._persistQueue()\n    }\n\n    reject(error)\n  }\n\n  _scheduleRetries(attempt = 1) {\n    if (this.retryTimer) clearTimeout(this.retryTimer)\n\n    if (this.queue.size === 0) {\n      debugLog(this.config.debug, 'Queue is empty, stopping retries.')\n      return\n    }\n\n    const maxRetryCycles = this.config.maxRetryCycles || 10\n    if (attempt > maxRetryCycles) {\n      debugLog(\n        this.config.debug,\n        'Max retry attempts reached, stopping retries.',\n      )\n      return\n    }\n\n    const maxDelay = this.config.maxRetryDelay || 300000\n    const delay = Math.min(\n      this.config.retryInterval * 2 ** (attempt - 1),\n      maxDelay,\n    )\n\n    this.retryTimer = setTimeout(() => {\n      this.flush()\n      this._scheduleRetries(attempt + 1)\n    }, delay)\n  }\n\n  _eventHandler() {\n    if (!this.config.autoFlush) return\n\n    this.abortController.abort()\n    this.abortController = new AbortController()\n\n    const handler = () => {\n      if (this.queue.size > 0) {\n        debugLog(this.config.debug, 'Auto-flushing queue due to unload event.')\n        this.flush()\n      } else if (this.config.debug) {\n        debugLog(this.config.debug, 'Queue is empty, skipping auto-flush.')\n      }\n    }\n\n    const { signal } = this.abortController\n\n    ;['pagehide', 'beforeunload', 'visibilitychange'].forEach((event) => {\n      window.addEventListener(event, handler, { signal })\n    })\n  }\n\n  _loadQueue() {\n    try {\n      const stored = localStorage.getItem(this.config.storeKey)\n      if (stored) {\n        const parsed = JSON.parse(stored)\n        if (Array.isArray(parsed)) {\n          this.queue = new Set(parsed)\n          debugLog(\n            this.config.debug,\n            `Loaded queue from storage: ${parsed.length} items`,\n          )\n        }\n      }\n    } catch (error) {\n      debugLog(this.config.debug, 'Error loading queue:', error)\n      this.queue.clear()\n    }\n  }\n\n  _persistQueue = debounce(() => {\n    if (!this.config.storeFailed || this.queue.size === 0) {\n      if (this.config.debug) {\n        debugLog(\n          this.config.debug,\n          'Skipping persistence: queue is empty or storeFailed is false.',\n        )\n      }\n      return\n    }\n\n    try {\n      const serialized = JSON.stringify(\n        [...Array.from(this.queue)].slice(0, 100),\n      )\n      localStorage.setItem(this.config.storeKey, serialized)\n      debugLog(this.config.debug, `Persisted queue: ${this.queue.size} items`)\n    } catch (error) {\n      debugLog(this.config.debug, 'Persist error:', error)\n    }\n  }, 500)\n}\n"],"names":[],"mappings":"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"}